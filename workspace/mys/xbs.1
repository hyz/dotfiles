#!/bin/env python3

import sys, os
# 0:code 1:date
#     2:lv0.3 m20s[3:v 4:a] m20b[5:v 6:a] s[7:v 8:a] b[9:v 10:a] 4:ochl
# # # #

class Lis(list):
    #def __init__(self): super().__init__() self.date = 0
    def add(self, d, v):
        super().append(v)
        self.date = d

def Print(c, n, m, *t):
    print('%06d %d %d' % (c, n, m)
            , *['{:.2f}'.format(x) for x in t]
            , sep='\t')
    #print('\t', n, sep=None)

def Main():
    sdic = {}

    for fn in sys.argv[1:]:
        for l in open(fn):
            v = l.strip().split('\t')
            c, d, v = int(v[0]), v[1], [float(x) for x in v[2:]]
            v.append(int(d))
            sdic.setdefault(c, []).append(v)
    lastdate = int(os.path.basename(sys.argv[-1]))

    for code,ld in sdic.items():
        if ld[-1][-1] != lastdate:
            continue
        v = list(zip(*ld))
        b = sum(v[8])
        s = sum(v[6])
        if int(b) == 0:
            continue
        Print(code, len([1 for u in ld if u[6]<u[8]]), len(ld)
                , (b-s)/10000, (b-s)/b*100, *[ (y-x)/10000 for x,y in zip(v[6], v[8]) ])

if __name__ == '__main__':
    Main()
